webpackJsonp([24],{awkC:function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=a("O2NY"),s=a.n(t),l={data:function(){return{picurl:"http://lb3.28888753.cn/imges/",isActive:1,ruleForm:{busName:"",cardPicUrl:""},ruleFormRouls:{busName:[{required:!0,message:"请填写商户名称",trigger:"blur"}],cardPicUrl:[{required:!0,message:"请上传图片",trigger:"blur"}]},carMsgFrom:{cardName:"",cardBagColor:"",actTime:[],state:"",del:"",serverPhone:"",share:"1",type:""},cardBagSel:[{color:"#63b359",label:"1"},{color:"#2c9f67",label:"2"},{color:"#509fc9",label:"3"},{color:"#5885cf",label:"4"},{color:"#9062c0",label:"5"},{color:"#d09a45",label:"6"},{color:"#e4b138",label:"7"},{color:"#ee903c",label:"8"},{color:"#f08500",label:"9"},{color:"#a9d92d",label:"10"},{color:"#dd6549",label:"11"},{color:"#cc463d",label:"12"},{color:"#cf3e36",label:"13"},{color:"#516671",label:"14"}],busType:[],carMsgFromRules:{cardName:[{required:!0,message:"请输入卡劵名称",trigger:"blur"}],cardBagColor:[{required:!0,message:"请选择卡劵背景颜色",trigger:"blur"}],actTime:[{required:!0,message:"请选择使用时间",trigger:"blur"}],state:[{required:!0,message:"请填写卡券使用说明",trigger:"blur"}],del:[{required:!0,message:"请填写优惠详情",trigger:"blur"}],serverPhone:[{required:!0,message:"请输入正确的客服电话",trigger:"blur"}]}}},created:function(){this.busTypeFun()},methods:{handleFileChange:function(){var e=this,r=this.$refs.inputer;this.file=r.files[0];Math.floor(this.file.size/1024);this.formData=new FormData,this.formData.append("file",this.file),this.formData.append("uid",localStorage.getItem("uid")),this.$http.post(this.$api.cardPic.cardPic,this.formData,!0).then(function(r){e.ruleForm.cardPicUrl=r.data.url})},delPic:function(){this.ruleForm.cardPicUrl=""},cardBusMsg:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;r.isActive+=1})},busTypeFun:function(){var e=this,r=new URLSearchParams;r.append("uid",localStorage.getItem("uid")),this.$http.post(this.$api.busTypeUrl.busTypeUrl,r,!0).then(function(r){console.log("卡劵商家服务类型集合",r),"success"==r.data.state&&(e.busType=r.data.getcardBusinessServiceTypesVOList)})},cardMsgForm:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return!1;var a="2",t=r.moment(r.carMsgFrom.actTime[0]).format("YYYY-MM-DD HH:mm:ss"),l=r.moment(r.carMsgFrom.actTime[0]).format("YYYY-MM-DD HH:mm:ss");console.log("this.ruleForm.busName",r.ruleForm.busName);var o=new URLSearchParams;o.append("uid",localStorage.getItem("uid")),o.append("businessName",r.ruleForm.busName),o.append("images",r.ruleForm.cardPicUrl),o.append("cardName",r.carMsgFrom.cardName),o.append("cardBackgroundColor",r.carMsgFrom.cardBagColor),o.append("startingTime",t),o.append("endTime",l),o.append("cardInstructions",r.carMsgFrom.state),o.append("offerDetails",r.carMsgFrom.del),o.append("customerServicePhone",r.carMsgFrom.serverPhone),a=r.ruleForm.share?"1":"2",o.append("share",a),o.append("businessServiceTypes",r.carMsgFrom.type),r.$http.post(r.$api.addCard.addCard,o,!0).then(function(e){console.log("添加卡劵第二步",e),"success"==e.data.state&&s.a.errPrompt(r.$message({message:"恭喜你，添加卡劵成功",type:"success"})),r.$router.push({path:"/act/card"})})})},prevStep:function(){this.isActive-=1}}},o={render:function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("div",{staticClass:"addcard"},[a("el-card",{staticClass:"addcard-card"},[a("el-steps",{staticClass:"step-line",staticStyle:{"margin-top":"20px"},attrs:{active:e.isActive,"finish-status":"success",simple:""}},[a("el-step",{attrs:{title:"卡劵商户信息"}}),e._v(" "),a("el-step",{attrs:{title:"卡劵基础信息"}})],1),e._v(" "),1==e.isActive?a("div",{staticClass:"main"},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.ruleFormRouls}},[a("el-form-item",{attrs:{prop:"busName"}},[a("el-input",{staticClass:"busName",attrs:{placeholder:"请输入商户名称"},model:{value:e.ruleForm.busName,callback:function(r){e.$set(e.ruleForm,"busName",r)},expression:"ruleForm.busName"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"cardPicUrl"}},[a("div",{staticClass:"prompt",staticStyle:{"padding-left":"0px","margin-top":"10px","margin-bottom":"26px","line-height":"0"}},[e._v("注：商户名称字数上限为12个汉字，该字段提交后不可更改。")]),e._v(" "),a("div",{staticClass:"cardPic"},[""==e.ruleForm.cardPicUrl?a("div",{staticClass:"warpper"},[a("i",{staticClass:"el-icon-plus"}),e._v(" "),a("input",{ref:"inputer",attrs:{type:"file",name:"sharePic"},on:{change:function(r){return e.handleFileChange(r)}}})]):a("div",{staticClass:"warpper"},[a("div",{staticClass:"cover"},[a("i",{staticClass:"el-icon-delete",on:{click:e.delPic}})]),e._v(" "),a("img",{attrs:{src:e.picurl+e.ruleForm.cardPicUrl}})])])]),e._v(" "),a("div",{staticClass:"prompt",staticStyle:{"padding-left":"0px"}},[e._v("注：商户logo建议像素为300*300，大小不能超过1M，图片格式只能为JPG 或 PNG。")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.cardBusMsg("ruleForm")}}},[e._v("下一步")])],1)],1):a("div",{staticClass:"main-one"},[a("el-form",{ref:"carMsgFrom",attrs:{model:e.carMsgFrom,rules:e.carMsgFromRules,"label-width":"250px"}},[a("el-form-item",{attrs:{label:"卡劵名称",prop:"cardName"}},[a("el-input",{attrs:{placeholder:"字数上线为9个汉字"},model:{value:e.carMsgFrom.cardName,callback:function(r){e.$set(e.carMsgFrom,"cardName",r)},expression:"carMsgFrom.cardName"}})],1),e._v(" "),a("div",{staticClass:"prompt"},[e._v("注：商户logo建议像素为300*300，大小不能超过1M，图片格式只能为JPG 或 PNG。")]),e._v(" "),a("el-form-item",{attrs:{label:"卡劵背景颜色",prop:"cardBagColor"}},[a("el-select",{attrs:{placeholder:"请选择code码形式"},model:{value:e.carMsgFrom.cardBagColor,callback:function(r){e.$set(e.carMsgFrom,"cardBagColor",r)},expression:"carMsgFrom.cardBagColor"}},e._l(e.cardBagSel,function(e,r){return a("el-option",{key:r,style:"background:"+e.color+";color:#fff;text-align: center;",attrs:{label:e.color,value:e.color}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"使用时间",required:"",prop:"actTime"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.carMsgFrom.actTime,callback:function(r){e.$set(e.carMsgFrom,"actTime",r)},expression:"carMsgFrom.actTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"卡劵使用说明",prop:"state"}},[a("el-input",{attrs:{type:"textarea",placeholder:"字数上线为1024个汉字"},model:{value:e.carMsgFrom.state,callback:function(r){e.$set(e.carMsgFrom,"state",r)},expression:"carMsgFrom.state"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"优惠详情",prop:"del"}},[a("el-input",{attrs:{type:"textarea",placeholder:"字数上线为500个汉字"},model:{value:e.carMsgFrom.del,callback:function(r){e.$set(e.carMsgFrom,"del",r)},expression:"carMsgFrom.del"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客服电话",prop:"serverPhone"}},[a("el-input",{attrs:{placeholder:"最多25个字符"},model:{value:e.carMsgFrom.serverPhone,callback:function(r){e.$set(e.carMsgFrom,"serverPhone",r)},expression:"carMsgFrom.serverPhone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"与其他优惠共享"}},[a("el-switch",{model:{value:e.carMsgFrom.share,callback:function(r){e.$set(e.carMsgFrom,"share",r)},expression:"carMsgFrom.share"}})],1),e._v(" "),a("div",{staticClass:"prompt"},[e._v("注：默认打开，系统在使用须知里 拼写“可与其他优惠共享”。关闭时系统将在使用须知里 拼写“不可与其他优惠共享”。")]),e._v(" "),a("el-form-item",{attrs:{label:"商家服务类型"}},[a("el-select",{attrs:{placeholder:"请选择商家服务类型"},model:{value:e.carMsgFrom.type,callback:function(r){e.$set(e.carMsgFrom,"type",r)},expression:"carMsgFrom.type"}},e._l(e.busType,function(e,r){return a("el-option",{key:r,attrs:{label:e.businessServiceTypesName,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:e.prevStep}},[e._v("上一步")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.cardMsgForm("carMsgFrom")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var c=a("C7Lr")(l,o,!1,function(e){a("t0R4")},"data-v-5fcff248",null);r.default=c.exports},t0R4:function(e,r){}});
//# sourceMappingURL=24.34b7c779c9d8d245f92d.js.map